WITH students AS (SELECT Н_УЧЕНИКИ.ГРУППА, Н_УЧЕНИКИ.ИД, Н_ЛЮДИ.ФАМИЛИЯ, Н_ЛЮДИ.ИМЯ, Н_ФОРМЫ_ОБУЧЕНИЯ.НАИМЕНОВАНИЕ, Н_УЧЕНИКИ.ПРИЗНАК, Н_УЧЕНИКИ.КОНЕЦ FROM Н_УЧЕНИКИ INNER JOIN Н_ФОРМЫ_ОБУЧЕНИЯ ON Н_УЧЕНИКИ.ВИД_ОБУЧ_ИД = Н_ФОРМЫ_ОБУЧЕНИЯ.ИД INNER JOIN Н_ЛЮДИ ON Н_УЧЕНИКИ.ЧЛВК_ИД = Н_ЛЮДИ.ИД)
SELECT ГРУППА, ИД, ФАМИЛИЯ, ИМЯ FROM students WHERE EXISTS (SELECT 1 FROM students WHERE НАИМЕНОВАНИЕ = 'Очно-заочная(вечерняя)' AND ПРИЗНАК = 'отчисл' AND КОНЕЦ < CAST('01-09-2012' as date));